window.__require=function e(t,n,o){function i(c,s){if(!n[c]){if(!t[c]){var a=c.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+c+"'")}}var u=n[c]={exports:{}};t[c][0].call(u.exports,function(e){return i(t[c][1][e]||e)},u,u.exports,e,t,n,o)}return n[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<o.length;c++)i(o[c]);return i}({EventNames:[function(e,t,n){"use strict";cc._RF.push(t,"29144VOdc9K8pQth4oBIBqf","EventNames"),function(){var e;e={GAME_START:"game.start",GAME_GET_LEVEL:"game.get.level",GAME_NEXT_LEVEL:"game.next.level",GAME_FINISH:"game.finish",GAME_SPELL_WORD:"game.spell.word"},t.exports=e}.call(this),cc._RF.pop()},{}],GameDialog:[function(e,t,n){"use strict";cc._RF.push(t,"71479Vu999JaI/3x1c26eWd","GameDialog"),function(){var t,n,o=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};n=e("./common/Utils"),t=e("./common/EventNames"),cc.Class({extends:cc.Component,properties:{m_letter_prefab:cc.Prefab,m_blank_prefab:cc.Prefab,m_game_node:cc.Node,m_blank_node:cc.Node},onLoad:function(){this._charNodeTable=[],this._selectDeskItemTable=[],this._blankPositionMap={},this._initDesk(),this._wordsTable=this._getWordsTable(),this._initWordsNode(),this._addTouchEvent(),this._initBlank(),this._updateDeskStatus()},_updateDeskStatus:function(){return this._tryDownDeskItemForeach(),this.scheduleOnce(function(e){return function(){return e._tryMoveToRightForEach()}}(this),.5)},_getCoordinate:function(e){return{row:Math.floor(e/9)+1,col:e%9}},_getIndexByCoordinate:function(e,t){return 9*(e-1)+t},_isDeskItemIsNull:function(e){return null==this._deskItemTable[e].item},_getDownIndex:function(e){var t,n;if(n=-1,(t=this._getCoordinate(e)).row-1<0)return n;for(;t.row-1>0&&(e=this._getIndexByCoordinate(t.row-1,t.col),null==this._deskItemTable[e].item);)n=e,t=this._getCoordinate(e);return n},_getRightIndex:function(e){var t,n;if(n=-1,(t=this._getCoordinate(e)).col+1>=9)return n;for(;t.col+1<9&&(e=this._getIndexByCoordinate(t.row,t.col+1),null==this._deskItemTable[e].item);)n=e,t=this._getCoordinate(e);return n},_exchangeDeskItem:function(e,t){var n,o,i;return n=this._deskItemTable[e],i=this._deskItemTable[t],n.item.runAction(cc.moveTo(.5,i.position)),(o={}).item=n.item,o.char=n.char,n.item=i.item,n.char=i.char,i.item=o.item,i.char=o.char},_tryDownDeskItemForeach:function(){var e,t,n,o,i;for(n=t=0,o=(i=this._deskItemTable).length;t<o;n=++t)null!=i[n].item&&-1!==(e=this._getDownIndex(n))&&!1!==this._isDeskItemIsNull(e)&&this._exchangeDeskItem(n,e)},_tryMoveToRightForEach:function(){var e,t,n,o,i,r,c,s,a;for(i=0,r=e=0,9;e<9;r=++e)for(a=n=0,o=(c=[8,17,26,35,44,53,62,71,80]).length;n<o;a=++n)if(t=c[a],t-=r,null!=this._deskItemTable[t].item)if(0===a){if(-1===(s=this._getRightIndex(t)))continue;if(!1===this._isDeskItemIsNull(s))continue;i=s-t,this._exchangeDeskItem(t,s)}else this._exchangeDeskItem(t,i+t)},_getPositionByCoordinate:function(e,t){var n,o;return n=63*t,o=63*e,cc.v2(n,o)},_createCharNode:function(e,t){var n;return n=cc.instantiate(this.m_letter_prefab),this.m_game_node.addChild(n),n.setPosition(e.position),e.item=n,e.char=t,this._setChar(n,t),n},_initDesk:function(){var e,t,n,o,i,r;for(this._deskItemTable=[],i=e=0,9;e<9;i=++e)for(r=t=0,o=9;0<=o?t<o:t>o;r=0<=o?++t:--t)n=this._getPositionByCoordinate(i,r),this._deskItemTable.push({position:n})},_getWordsTable:function(){var e;return e=[],n.triggerEvent(t.GAME_GET_LEVEL,function(t){return e=t}),e},_initBlank:function(){var e,t,n,o,i,r,c,s,a,l,u,d;for(l=t=0,i=(s=this._wordsTable).length;t<i;l=++t){for(u=[],n=o=0,r=(a=s[l]).length;o<r;n=++o)a[n],e=cc.instantiate(this.m_blank_prefab),this.m_blank_node.addChild(e),this._setCharNodePosition(e,l,n),d=this.m_blank_node.convertToWorldSpaceAR(e.getPosition()),c=this.m_game_node.convertToNodeSpaceAR(d),u.push(c);this._blankPositionMap[a]=u}},_findPositionTableInDesk:function(e){var t,o,i,r,c,s,a,l,u,d,h,_,m,f,g,v;for(console.log("length :"+e),d=[],t=0,n.randomInt(1,10)<=5&&(t=1),u=i=0,9;i<9;u=++i)for(g=c=0,l=(h=[8,17,26,35,44,53,62,71,80]).length;c<l;g=++c)if(r=h[g]-u,0===t){if(null!=this._deskItemTable[r].item)continue;if(-1===(f=this._getRightIndex(r)))continue;if(f-r>=e){for(u=s=0,_=e;0<=_?s<_:s>_;u=0<=_?++s:--s)v=r+u,this._deskItemTable[v].item=!0,d.push(v);return d}}else{if(null!=this._deskItemTable[r].item)continue;if(-1===(o=this._getDownIndex(r)))continue;if((r-o)/9>=e-1){for(u=a=0,m=e;0<=m?a<m:a>m;u=0<=m?++a:--a)v=o+9*u,this._deskItemTable[v].item=!0,d.push(v);return d}}},_dumpDeskItem:function(){var e,t,n,o;for(t=0,n=(o=this._deskItemTable).length;t<n;t++)e=o[t],console.log("--------------item:"+e.item+", char:"+e.char+"------------")},_initWordsNode:function(){var e,t,n,o,i,r,c,s,a,l;for(l=t=0,i=(s=this._wordsTable).length;t<i;l=++t)for(a=s[l],c=this._findPositionTableInDesk(a.length),n=o=0,r=a.length;o<r;n=++o)e=a[n],this._createCharNode(this._deskItemTable[c[n]],e)},_setCharNodePosition:function(e,t,n){var o,i,r;return i=100+63*n,r=63*t+50,o=cc.v2(i,r),e.setPosition(o)},_setChar:function(e,t){return cc.find("letter",e).getComponent(cc.Label).string=t},_getChar:function(e){return e?cc.find("letter",e).getComponent(cc.Label).string:""},_getCharNodeRect:function(e){var t;return t=e.getBoundingBox(),new cc.Rect(t.x,t.y,t.width,t.height)},_changeCharNodeBgColor:function(e,t){return cc.find("bg",e).color=t},_addCharNodeScaleAni:function(e,t){var n;return n=cc.scaleTo(.1,t),e.runAction(n)},_checkIsOnChar:function(e){var t,n,i,r;for(this._isPlayAnim=!1,n=0,i=(r=this._deskItemTable).length;n<i;n++)null!=(t=r[n]).item&&(!this._getCharNodeRect(t.item).contains(e)||o.call(this._selectDeskItemTable,t)>=0||(this._selectDeskItemTable.push(t),this._changeCharNodeBgColor(t.item,cc.Color.GREEN)));this._isPlayAnim=!0},_dealCharString:function(){var e,i,r,c,s,a,l,u,d,h,_,m;for(i=[],c=0,l=(h=this._selectDeskItemTable).length;c<l;c++)e=(r=h[c]).item.getChildByName("letter").getComponent(cc.Label).string,i.push(e);if(i=i.join(""),o.call(this._wordsTable,i)>=0)for(d=this._blankPositionMap[i],s=a=0,u=(_=this._selectDeskItemTable).length;a<u;s=++a)m=(r=_[s]).item,this._flyToTarget(m,d[s]),r.item=void 0,r.char=void 0;return this.scheduleOnce(function(e){return function(){return n.triggerEvent(t.GAME_SPELL_WORD,i),e._updateDeskStatus()}}(this),.5),i},_flyToTarget:function(e,t){var n,o,i;return n=cc.moveTo(.5,t),o=cc.scaleTo(.5,.66),i=cc.spawn(n,o),e.runAction(i)},_onTouchEnd:function(){var e,t,n,o;for(this._dealCharString(),t=0,n=(o=this._selectDeskItemTable).length;t<n;t++)null!=(e=o[t]).item&&this._changeCharNodeBgColor(e.item,cc.Color.WHITE);this._selectDeskItemTable=[]},_addTouchEvent:function(){return this.m_game_node.on(cc.Node.EventType.TOUCH_START,function(e){return function(t){var n;return n=e.m_game_node.convertToNodeSpaceAR(t.getLocation()),e._checkIsOnChar(n)}}(this)),this.m_game_node.on(cc.Node.EventType.TOUCH_MOVE,function(e){return function(t){var n;return n=e.m_game_node.convertToNodeSpaceAR(t.getLocation()),e._checkIsOnChar(n)}}(this)),this.m_game_node.on(cc.Node.EventType.TOUCH_END,function(e){return function(t){return e.m_game_node.convertToNodeSpaceAR(t.getLocation()),e._onTouchEnd()}}(this)),this.m_game_node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){return function(t){return e.m_game_node.convertToNodeSpaceAR(t.getLocation()),e._onTouchEnd()}}(this))}})}.call(this),cc._RF.pop()},{"./common/EventNames":void 0,"./common/Utils":void 0}],GameLogic:[function(e,t,n){"use strict";cc._RF.push(t,"0d8bc0pe0pATbUHPVeWQuz3","GameLogic"),function(){var t,n,o,i;o=e("./common/Utils"),t=e("./common/EventNames"),i=e("./config/wordConfig"),n=i.wordTable,cc.Class({extends:cc.Component,properties:{},onLoad:function(){return cc.game.addPersistRootNode(this.node),this._registerEvent(),this._level=0,this._currentLevelWordsTable=[]},_registerEvent:function(){return o.bindEvent(t.GAME_START,function(){return cc.director.loadScene("GameDialog")}),o.bindEvent(t.GAME_GET_LEVEL,function(e){return function(t){return t(e._getLevelWords())}}(this)),o.bindEvent(t.GAME_NEXT_LEVEL,function(e){return function(){return e._level++,e._level>n.length-1?cc.director.loadScene("WelcomeDialog"):cc.director.loadScene("GameDialog")}}(this)),o.bindEvent(t.GAME_FINISH,function(){return cc.director.loadScene("LevelClearDialog")}),o.bindEvent(t.GAME_SPELL_WORD,function(e){return function(t){var n,o,i,r;for(o=n=0,i=(r=e._currentLevelWordsTable).length;n<i;o=++n)if(t===r[o]){e._currentLevelWordsTable.splice(o,1);break}0===e._currentLevelWordsTable.length&&cc.director.loadScene("LevelClearDialog")}}(this))},_getLevelWords:function(){return this._currentLevelWordsTable=n[this._level],this._currentLevelWordsTable}})}.call(this),cc._RF.pop()},{"./common/EventNames":void 0,"./common/Utils":void 0,"./config/wordConfig":void 0}],LevelClearDialog:[function(e,t,n){"use strict";cc._RF.push(t,"c2517xfISlGL63GQ5GiWVN8","LevelClearDialog"),function(){var t,n;n=e("./common/Utils"),t=e("./common/EventNames"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},onNextLevel:function(){return n.triggerEvent(t.GAME_NEXT_LEVEL)}})}.call(this),cc._RF.pop()},{"./common/EventNames":void 0,"./common/Utils":void 0}],RecordLogic:[function(e,t,n){"use strict";cc._RF.push(t,"11266MRE8pEPJi2ITrrVcUF","RecordLogic"),function(){cc.Class({extends:cc.Component,properties:{},onLoad:function(){return cc.game.addPersistRootNode(this.node)},setData:function(e){return this._data=e},getData:function(){return this._data}})}.call(this),cc._RF.pop()},{}],Utils:[function(e,t,n){"use strict";cc._RF.push(t,"6c7e8GM20xF8YJ8Zz1qGVgq","Utils"),function(){var e;e={bindEvent:function(e,t){return cc.director.getScene().getChildByName("LogicNode").on(e,t)},triggerEvent:function(e,t){return cc.director.getScene().getChildByName("LogicNode").emit(e,t)},getDataFromNode:function(){return cc.director.getScene().getChildByName("RecordNode").getComponent("Record").getData()},setDataOnNode:function(e){return cc.director.getScene().getChildByName("RecordNode").getComponent("Record").setData(e)},formatNum:function(e){return(e+"").replace(/\d{1,3}(?=(\d{3})+$)/g,"$&,")},setItem:function(e,t){return cc.sys.localStorage.setItem(e,JSON.stringify(t))},getItem:function(e){try{return JSON.parse(cc.sys.localStorage.getItem(e))}catch(e){}},randomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},t.exports=e}.call(this),cc._RF.pop()},{}],WelcomdDialog:[function(e,t,n){"use strict";cc._RF.push(t,"4dd36K7Fb9OpLeMXJeVg7Hy","WelcomdDialog"),function(){var t,n;n=e("./common/Utils"),t=e("./common/EventNames"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},onBegin:function(){return n.triggerEvent(t.GAME_START)}})}.call(this),cc._RF.pop()},{"./common/EventNames":void 0,"./common/Utils":void 0}],wordConfig:[function(e,t,n){"use strict";cc._RF.push(t,"0a7a0ZCsV5I8pw/iESfFGLg","wordConfig"),function(){t.exports={wordTable:[["HELLO","WORLD","NICE","ONE","TWO"],["GOOD","OK","ASK"],["\u6210\u8bed\u63a5\u9f99","\u4e00\u5e06\u98ce\u987a"]]}}.call(this),cc._RF.pop()},{}]},{},["EventNames","Utils","wordConfig","GameLogic","RecordLogic","GameDialog","LevelClearDialog","WelcomdDialog"]);